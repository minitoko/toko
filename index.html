<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Marketplace Mobile - Listyo</title>
    <style>
        :root {
            --primary: #4f46e5;       /* indigo */
            --primary-dark: #4338ca;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
        }

        * { box-sizing: border-box; margin:0; padding:0; }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 70px;
        }

        /* Desktop warning */
        @media (min-width: 768px) {
            body::before {
                content: "Website ini hanya dapat diakses di perangkat mobile";
                position: fixed;
                inset: 0;
                background: rgba(0,0,0,0.92);
                color: white;
                font-size: 1.5rem;
                font-weight: 600;
                display: flex;
                align-items: center;
                justify-content: center;
                text-align: center;
                padding: 2rem;
                z-index: 9999;
            }
        }

        header {
            background: var(--primary);
            color: white;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
        }

        header h1 {
            text-align: center;
            padding: 12px 0;
            font-size: 1.35rem;
        }

        .categories {
            display: flex;
            overflow-x: auto;
            padding: 0 12px 12px;
            gap: 12px;
            scrollbar-width: none;
        }

        .categories::-webkit-scrollbar { display: none; }

        .category-btn {
            flex-shrink: 0;
            padding: 8px 20px;
            background: rgba(255,255,255,0.25);
            border-radius: 999px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .category-btn.active,
        .category-btn:hover {
            background: white;
            color: var(--primary-dark);
        }

        /* Slider */
        .slider-container {
            position: relative;
            height: 180px;
            overflow: hidden;
        }

        .slides {
            display: flex;
            height: 100%;
            transition: transform 0.4s ease;
        }

        .slide {
            min-width: 100%;
            background-size: cover;
            background-position: center;
        }

        .slider-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.4);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 1.4rem;
            cursor: pointer;
        }

        #prev { left: 12px; }
        #next { right: 12px; }

        /* Produk Grid */
        .products {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 16px;
        }

        .product-card {
            background: var(--card);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.15s ease;
        }

        .product-card:hover {
            transform: translateY(-4px);
        }

        .product-card img {
            width: 100%;
            height: 160px;
            object-fit: cover;
        }

        .product-info {
            padding: 12px;
            text-align: center;
        }

        .product-info .category {
            font-size: 0.78rem;
            color: var(--text-light);
            margin-bottom: 4px;
        }

        .product-info .price {
            font-size: 1.18rem;
            font-weight: 700;
            color: var(--primary);
            margin: 6px 0 10px;
        }

        .product-info button {
            background: var(--primary);
            color: white;
            border: none;
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .product-info button:hover {
            background: var(--primary-dark);
        }

        /* Bottom Nav */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            box-shadow: 0 -3px 12px rgba(0,0,0,0.08);
            z-index: 100;
        }

        .bottom-nav button {
            flex: 1;
            padding: 12px 0;
            background: none;
            border: none;
            font-size: 0.9rem;
            color: var(--text-light);
            cursor: pointer;
            transition: color 0.2s;
        }

        .bottom-nav button.active {
            color: var(--primary);
            font-weight: 600;
        }

        /* Popup */
        .popup {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 200;
            padding: 16px;
        }

        .popup-content {
            background: white;
            border-radius: 16px;
            width: 100%;
            max-width: 420px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow);
        }

        .close-btn {
            position: absolute;
            top: 12px;
            right: 16px;
            font-size: 2rem;
            color: #64748b;
            cursor: pointer;
        }

        .popup h2 {
            padding: 16px 16px 0;
            margin-bottom: 8px;
        }

        .cart-list {
            padding: 0 16px;
            list-style: none;
        }

        .cart-item {
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            font-size: 0.95rem;
        }

        .total-section {
            padding: 16px;
            border-top: 1px solid var(--border);
            background: #f8fafc;
        }

        .total-section p {
            font-size: 1.1rem;
            margin: 8px 0;
        }

        .total-section .grand-total {
            font-size: 1.35rem;
            font-weight: 700;
            color: var(--primary);
        }

        .order-btn {
            background: var(--primary);
            color: white;
            border: none;
            width: 100%;
            padding: 14px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 10px;
            margin-top: 12px;
            cursor: pointer;
        }

        .form-group {
            padding: 0 16px 16px;
        }

        .form-group label {
            display: block;
            margin: 12px 0 6px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-group textarea { min-height: 90px; }

        /* Hide class */
        .hidden { display: none !important; }
    </style>
</head>
<body>

<header>
    <h1>Marketplace Mobile</h1>
    <div class="categories" id="categoryNav">
        <div class="category-btn active" data-category="all">Semua</div>
        <div class="category-btn" data-category="baju">Baju</div>
        <div class="category-btn" data-category="mainan">Mainan</div>
        <div class="category-btn" data-category="elektronik">Elektronik</div>
        <div class="category-btn" data-category="lainnya">Lainnya</div>
    </div>
</header>

<div class="slider-container">
    <div class="slides" id="slides">
        <div class="slide" style="background-image:url('https://via.placeholder.com/420x180/4f46e5/ffffff?text=Promo+Terbaik')"></div>
        <div class="slide" style="background-image:url('https://via.placeholder.com/420x180/f97316/ffffff?text=Flash+Sale')"></div>
        <div class="slide" style="background-image:url('https://via.placeholder.com/420x180/10b981/ffffff?text=Produk+Unggulan')"></div>
    </div>
    <button class="slider-btn" id="prev">‹</button>
    <button class="slider-btn" id="next">›</button>
</div>

<section class="products" id="productGrid">
    <!-- Produk akan di-generate via JS -->
</section>

<!-- Bottom Navigation -->
<nav class="bottom-nav">
    <button class="active" id="btnHome">Depan</button>
    <button id="btnCart">Keranjang</button>
    <button id="btnProfile">Profil</button>
</nav>

<!-- Popup Keranjang -->
<div class="popup" id="cartPopup">
    <div class="popup-content">
        <span class="close-btn" onclick="closePopup('cartPopup')">×</span>
        <h2>Keranjang Belanja</h2>
        <ul class="cart-list" id="cartItems"></ul>
        <div class="total-section">
            <p>Catatan: <em>Belum termasuk ongkos kirim</em></p>
            <p class="grand-total">Total: Rp <span id="cartTotal">0</span></p>
            <button class="order-btn" onclick="orderViaWA()">Order Sekarang</button>
        </div>
    </div>
</div>

<!-- Popup Profil / Daftar -->
<div class="popup" id="profilePopup">
    <div class="popup-content">
        <span class="close-btn" onclick="closePopup('profilePopup')">×</span>
        <h2>Daftar Pelanggan</h2>
        <form class="form-group" id="registerForm">
            <label>Nama Lengkap</label>
            <input type="text" id="regName" required autocomplete="name">

            <label>Nomor HP (WhatsApp)</label>
            <input type="tel" id="regPhone" required autocomplete="tel">

            <label>Alamat Lengkap</label>
            <textarea id="regAddress" required></textarea>

            <button type="button" class="order-btn" onclick="saveUser()">Daftar</button>
        </form>
    </div>
</div>

<script>
// ────────────────────────────────────────────────
// Data Produk (bisa diperbanyak)
const products = [
    { id:1, name:"Kaos Polos Premium",       price:95000,  category:"baju",    img:"https://via.placeholder.com/300x300?text=Kaos" },
    { id:2, name:"Kemeja Flanel Cowok",       price:185000, category:"baju",    img:"https://via.placeholder.com/300x300?text=Kemeja" },
    { id:3, name:"LEGO Classic Medium",       price:320000, category:"mainan",  img:"https://via.placeholder.com/300x300?text=LEGO" },
    { id:4, name:"Robot Anak Edukasi",        price:245000, category:"mainan",  img:"https://via.placeholder.com/300x300?text=Robot" },
    { id:5, name:"Earphone TWS Pro",          price:399000, category:"elektronik", img:"https://via.placeholder.com/300x300?text=TWS" },
    { id:6, name:"Powerbank 20000mAh",        price:285000, category:"elektronik", img:"https://via.placeholder.com/300x300?text=Powerbank" },
    { id:7, name:"Tas Ransel Anti Air",       price:165000, category:"lainnya", img:"https://via.placeholder.com/300x300?text=Tas" },
    { id:8, name:"Jam Tangan Kasual",         price:220000, category:"lainnya", img:"https://via.placeholder.com/300x300?text=Jam" },
];

// ────────────────────────────────────────────────
// Variabel global
let cart = [];
let user = null;
let currentCategory = "all";
let slideIndex = 0;

// ────────────────────────────────────────────────
// Load data awal
function loadData() {
    cart = JSON.parse(localStorage.getItem('cart') || '[]');
    user = JSON.parse(localStorage.getItem('user') || 'null');
}

// Simpan data
function saveData() {
    localStorage.setItem('cart', JSON.stringify(cart));
    localStorage.setItem('user', JSON.stringify(user));
}

// ────────────────────────────────────────────────
// Render produk
function renderProducts() {
    const grid = document.getElementById('productGrid');
    grid.innerHTML = '';

    const filtered = currentCategory === "all" 
        ? products 
        : products.filter(p => p.category === currentCategory);

    filtered.forEach(p => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
            <img src="${p.img}" alt="${p.name}">
            <div class="product-info">
                <div class="category">${p.category.charAt(0).toUpperCase() + p.category.slice(1)}</div>
                <div class="price">Rp ${p.price.toLocaleString('id-ID')}</div>
                <button onclick="addToCart(${p.id})">Masuk Keranjang</button>
            </div>
        `;
        grid.appendChild(card);
    });
}

// ────────────────────────────────────────────────
// Filter kategori
document.querySelectorAll('.category-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelector('.category-btn.active').classList.remove('active');
        btn.classList.add('active');
        currentCategory = btn.dataset.category;
        renderProducts();
    });
});

// ────────────────────────────────────────────────
// Slider
const slides = document.getElementById('slides');
const totalSlides = slides.children.length;

function showSlide(n) {
    slideIndex = (n + totalSlides) % totalSlides;
    slides.style.transform = `translateX(-${slideIndex * 100}%)`;
}

document.getElementById('prev').onclick = () => showSlide(slideIndex - 1);
document.getElementById('next').onclick = () => showSlide(slideIndex + 1);

// auto slide (opsional)
setInterval(() => showSlide(slideIndex + 1), 5000);

// ────────────────────────────────────────────────
// Keranjang
function addToCart(id) {
    if (!user) {
        alert("Silakan daftar dulu di menu Profil");
        openPopup('profilePopup');
        return;
    }

    const prod = products.find(p => p.id === id);
    const exist = cart.find(item => item.id === id);

    if (exist) exist.qty++;
    else cart.push({ ...prod, qty: 1 });

    saveData();
    alert(`${prod.name} ditambahkan ke keranjang!`);
}

function updateCartDisplay() {
    const list = document.getElementById('cartItems');
    list.innerHTML = '';

    let total = 0;

    cart.forEach(item => {
        const subtotal = item.price * item.qty;
        total += subtotal;

        const li = document.createElement('li');
        li.className = 'cart-item';
        li.innerHTML = `
            <span>${item.name} × ${item.qty}</span>
            <span>Rp ${subtotal.toLocaleString('id-ID')}</span>
        `;
        list.appendChild(li);
    });

    document.getElementById('cartTotal').textContent = total.toLocaleString('id-ID');
}

// ────────────────────────────────────────────────
// Order via WA
function orderViaWA() {
    if (cart.length === 0) return alert("Keranjang kosong");

    let msg = `Halo, saya mau order:\n\n`;
    cart.forEach(i => {
        msg += `• ${i.name} × ${i.qty} = Rp ${ (i.price * i.qty).toLocaleString('id-ID') }\n`;
    });
    msg += `\nTotal: Rp ${document.getElementById('cartTotal').textContent}\n`;
    msg += `*Belum termasuk ongkir*\n\n`;
    msg += `Nama: ${user.name}\nHP: ${user.phone}\nAlamat: ${user.address}`;

    const url = `https://wa.me/6281234567890?text=${encodeURIComponent(msg)}`; // GANTI NOMOR
    window.open(url, '_blank');
    closePopup('cartPopup');
}

// ────────────────────────────────────────────────
// User registration
function saveUser() {
    const name  = document.getElementById('regName').value.trim();
    const phone = document.getElementById('regPhone').value.trim();
    const addr  = document.getElementById('regAddress').value.trim();

    if (!name || !phone || !addr) return alert("Lengkapi semua data");

    user = { name, phone, address: addr };
    saveData();
    closePopup('profilePopup');
    alert("Pendaftaran berhasil! Sekarang Anda bisa berbelanja.");
}

// ────────────────────────────────────────────────
// Popup control
function openPopup(id) {
    if (id === 'cartPopup' && !user) {
        alert("Silakan daftar terlebih dahulu");
        openPopup('profilePopup');
        return;
    }
    if (id === 'cartPopup') updateCartDisplay();
    document.getElementById(id).style.display = 'flex';
}

function closePopup(id) {
    document.getElementById(id).style.display = 'none';
}

// Bottom nav
document.getElementById('btnHome').onclick   = () => { /* sudah di home */ };
document.getElementById('btnCart').onclick   = () => openPopup('cartPopup');
document.getElementById('btnProfile').onclick = () => {
    if (user) alert(`Halo ${user.name}, Anda sudah terdaftar.`);
    else openPopup('profilePopup');
};

// Init
loadData();
renderProducts();
showSlide(0);
</script>
</body>
</html>
